[gd_scene load_steps=27 format=3 uid="uid://en3636qm60ra"]

[ext_resource type="Script" path="res://enemies/melee/melee_skin.gd" id="1_12iv5"]
[ext_resource type="ArrayMesh" uid="uid://chs03lfaocohd" path="res://objects/explosion/explosion_bits_B.res" id="1_jjy1h"]
[ext_resource type="PackedScene" uid="uid://duds002tisele" path="res://enemies/melee/minion/small_ennemy_animated.glb" id="2_ydhsr"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_1hmg7"]
animation = &"Hit-impact"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_a2nrj"]
animation = &"Attack"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_h4w4y"]
animation = &"Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_wcs7x"]
animation = &"Killed-impact"

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_xdwv5"]
filter_enabled = true
filters = ["Skeleton3D:DEF-Blindfold", "Skeleton3D:DEF-forearm.R", "Skeleton3D:DEF-forearm.R.001", "Skeleton3D:DEF-hand.R", "Skeleton3D:DEF-shoulder.R", "Skeleton3D:DEF-spine", "Skeleton3D:DEF-spine.001", "Skeleton3D:DEF-spine.002", "Skeleton3D:DEF-spine.003", "Skeleton3D:DEF-spine.004", "Skeleton3D:DEF-spine.005", "Skeleton3D:DEF-spine.006", "Skeleton3D:DEF-upper_arm.R", "Skeleton3D:DEF-upper_arm.R.001"]

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_sf8yh"]
filter_enabled = true
filters = ["Skeleton3D/Body_001:surface_material_override/0", "Skeleton3D:DEF-Blindfold", "Skeleton3D:DEF-spine.005", "Skeleton3D:DEF-spine.006"]
mix_mode = 1

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ce2nm"]
animation = &"Run"

[sub_resource type="AnimationNodeTransition" id="AnimationNodeTransition_wld3h"]
xfade_time = 0.1
input_0/name = "Idling"
input_0/auto_advance = false
input_0/break_loop_at_end = false
input_0/reset = true
input_1/name = "Running"
input_1/auto_advance = false
input_1/break_loop_at_end = false
input_1/reset = true
input_2/name = "Dying"
input_2/auto_advance = false
input_2/break_loop_at_end = false
input_2/reset = true

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_o08rm"]
nodes/Animation/node = SubResource("AnimationNodeAnimation_1hmg7")
nodes/Animation/position = Vector2(600, 480)
nodes/attack/node = SubResource("AnimationNodeAnimation_a2nrj")
nodes/attack/position = Vector2(380, 480)
nodes/idle/node = SubResource("AnimationNodeAnimation_h4w4y")
nodes/idle/position = Vector2(180, 140)
nodes/killed/node = SubResource("AnimationNodeAnimation_wcs7x")
nodes/killed/position = Vector2(160, 460)
nodes/on_attacking/node = SubResource("AnimationNodeOneShot_xdwv5")
nodes/on_attacking/position = Vector2(580, 160)
nodes/on_hit/node = SubResource("AnimationNodeOneShot_sf8yh")
nodes/on_hit/position = Vector2(780, 140)
nodes/output/position = Vector2(980, 160)
nodes/run/node = SubResource("AnimationNodeAnimation_ce2nm")
nodes/run/position = Vector2(180, 300)
nodes/state/node = SubResource("AnimationNodeTransition_wld3h")
nodes/state/position = Vector2(400, 160)
node_connections = [&"on_attacking", 0, &"state", &"on_attacking", 1, &"attack", &"on_hit", 0, &"on_attacking", &"on_hit", 1, &"Animation", &"output", 0, &"on_hit", &"state", 0, &"idle", &"state", 1, &"run", &"state", 2, &"killed"]

[sub_resource type="Curve" id="Curve_hhmyj"]
_data = [Vector2(0, 0.615385), 0.0, -0.0714286, 0, 0, Vector2(1, 0), -2.03007, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_7der6"]
curve = SubResource("Curve_hhmyj")

[sub_resource type="Curve" id="Curve_137f5"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 0.538461), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_a3wc3"]
curve = SubResource("Curve_137f5")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_mkqib"]
emission_shape = 1
emission_sphere_radius = 1.0
gravity = Vector3(0, 2, 0)
scale_min = 0.5
scale_max = 1.5
scale_curve = SubResource("CurveTexture_a3wc3")
color = Color(0.85301, 0.762545, 0.740656, 1)
alpha_curve = SubResource("CurveTexture_7der6")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_w46x2"]
transparency = 1
diffuse_mode = 3
specular_mode = 2
vertex_color_use_as_albedo = true

[sub_resource type="SphereMesh" id="SphereMesh_nrawn"]
material = SubResource("StandardMaterial3D_w46x2")

[sub_resource type="Curve" id="Curve_7hyx8"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.631285, 0), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="CurveTexture" id="CurveTexture_p41r3"]
curve = SubResource("Curve_7hyx8")

[sub_resource type="Curve" id="Curve_l6dqp"]
_data = [Vector2(0, 1), 0.0, -4.28403, 0, 0, Vector2(0.73029, 0), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_g55m5"]
curve = SubResource("Curve_l6dqp")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_sx1j5"]
lifetime_randomness = 0.22
particle_flag_align_y = true
emission_shape = 1
emission_sphere_radius = 1.0
angle_min = -180.0
angle_max = 180.0
direction = Vector3(0, 1, 10)
spread = 67.693
initial_velocity_min = 10.0
initial_velocity_max = 10.0
angular_velocity_min = -300.0
angular_velocity_max = 300.0
angular_velocity_curve = SubResource("CurveTexture_p41r3")
radial_velocity_min = 9.99998
radial_velocity_max = 30.0
radial_velocity_curve = SubResource("CurveTexture_g55m5")
tangential_accel_min = -2.23517e-06
tangential_accel_max = -2.23517e-06
attractor_interaction_enabled = false
scale_min = 0.8
scale_max = 1.2
collision_mode = 1
collision_friction = 0.1
collision_bounce = 0.12

[sub_resource type="CylinderMesh" id="CylinderMesh_h823m"]
top_radius = 0.1
bottom_radius = 0.1
height = 1.5

[sub_resource type="BoxMesh" id="BoxMesh_u8d4u"]
size = Vector3(100, 1, 100)

[node name="MeleeSkin" type="Node3D"]
process_mode = 1
script = ExtResource("1_12iv5")

[node name="AnimationTree" type="AnimationTree" parent="."]
root_node = NodePath("../small_ennemy_animated")
tree_root = SubResource("AnimationNodeBlendTree_o08rm")
anim_player = NodePath("../small_ennemy_animated/AnimationPlayer")
parameters/current_length = 0.666667
parameters/current_position = 0.0931145
parameters/current_delta = 0.0166667
parameters/Animation/current_length = 0.366667
parameters/Animation/current_position = 0.366667
parameters/Animation/current_delta = 0.0309255
parameters/attack/current_length = 0.266667
parameters/attack/current_position = 0.266667
parameters/attack/current_delta = 0.033287
parameters/idle/current_length = 1.0
parameters/idle/current_position = 0.760247
parameters/idle/current_delta = 0.0257007
parameters/killed/current_length = 0.466667
parameters/killed/current_position = 0.466667
parameters/killed/current_delta = 0.0
parameters/on_attacking/current_length = 0.666667
parameters/on_attacking/current_position = 0.0931145
parameters/on_attacking/current_delta = 0.0166667
parameters/on_attacking/active = false
parameters/on_attacking/internal_active = false
parameters/on_attacking/request = 0
parameters/on_hit/current_length = 0.666667
parameters/on_hit/current_position = 0.0931145
parameters/on_hit/current_delta = 0.0166667
parameters/on_hit/active = false
parameters/on_hit/internal_active = false
parameters/on_hit/request = 0
parameters/output/current_length = 0.666667
parameters/output/current_position = 0.0931145
parameters/output/current_delta = 0.0166667
parameters/run/current_length = 0.666667
parameters/run/current_position = 0.0931145
parameters/run/current_delta = 0.0166667
parameters/state/current_length = 0.666667
parameters/state/current_position = 0.0931145
parameters/state/current_delta = 0.0166667
parameters/state/current_state = "Running"
parameters/state/transition_request = ""
parameters/state/current_index = 1

[node name="GPUParticles3D2" type="GPUParticles3D" parent="."]
emitting = false
amount = 40
process_material = SubResource("ParticleProcessMaterial_mkqib")
draw_pass_1 = SubResource("SphereMesh_nrawn")

[node name="GPUParticles3D" type="GPUParticles3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.95838, -1.63399)
emitting = false
amount = 6
lifetime = 0.4
one_shot = true
explosiveness = 1.0
randomness = 1.0
process_material = SubResource("ParticleProcessMaterial_sx1j5")
draw_pass_1 = ExtResource("1_jjy1h")

[node name="GPUParticlesCollisionBox3D" type="GPUParticlesCollisionBox3D" parent="GPUParticles3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -2.95838, 1.63399)
size = Vector3(40.3376, 0.979858, 53.9834)

[node name="Weapon_BoneAttachment" type="BoneAttachment3D" parent="."]
transform = Transform3D(-0.865786, -0.140928, 0.480161, 0.168933, -0.985508, 0.0153571, 0.471038, 0.0944111, 0.877046, -0.712522, 0.980103, 0.104684)
bone_name = "DEF-hand.R"
bone_idx = 24
use_external_skeleton = true
external_skeleton = NodePath("../small_ennemy_animated/Skeleton3D")

[node name="Weapon" type="MeshInstance3D" parent="Weapon_BoneAttachment"]
transform = Transform3D(0.858168, -0.382444, -0.342467, 0.353611, -0.0432493, 0.934392, -0.372164, -0.922966, 0.0981209, 0.116602, 0.268402, 0.560477)
mesh = SubResource("CylinderMesh_h823m")

[node name="small_ennemy_animated" parent="." instance=ExtResource("2_ydhsr")]

[node name="Skeleton3D" parent="small_ennemy_animated" index="0"]
bones/0/position = Vector3(0.00916448, 1.02419, 0.205919)
bones/0/rotation = Quaternion(0.136105, 0.00245865, 0.0210639, 0.990467)
bones/0/scale = Vector3(1.03129, 0.940246, 1.03129)
bones/1/position = Vector3(-7.61875e-10, 1.24582, 0.268058)
bones/1/rotation = Quaternion(0.146095, 0.002678, 0.0172428, 0.989117)
bones/1/scale = Vector3(1.04539, 0.996061, 1.04539)
bones/2/position = Vector3(-0.00764561, 1.47233, 0.336509)
bones/2/rotation = Quaternion(0.133227, 0.00217397, 0.0161702, 0.990951)
bones/2/scale = Vector3(1.05736, 1.05736, 1.05736)
bones/3/position = Vector3(-0.0132463, 1.64939, 0.385023)
bones/3/rotation = Quaternion(0.624107, 0.002341, 0.0183807, 0.781119)
bones/3/scale = Vector3(1.36188, 0.53933, 1.36188)
bones/4/position = Vector3(-0.0141433, 1.65415, 0.403779)
bones/4/rotation = Quaternion(0.510274, -0.000178427, 0.019276, 0.859796)
bones/4/scale = Vector3(1.35868, 0.541864, 1.35868)
bones/5/position = Vector3(-0.0146146, 1.66142, 0.416385)
bones/5/rotation = Quaternion(0.0055744, 8.9707e-05, 0.0160694, 0.999855)
bones/6/position = Vector3(-0.0276767, 2.31815, 0.361991)
bones/6/rotation = Quaternion(0.707015, 0.0113629, 0.0113629, 0.707015)
bones/6/scale = Vector3(1, 1, 1)
bones/7/position = Vector3(0.273829, 0.756689, 0.279612)
bones/7/rotation = Quaternion(0.909491, -0.00801935, 0.0664342, 0.410302)
bones/7/scale = Vector3(1.00551, 0.989088, 1.00551)
bones/8/position = Vector3(0.262052, 0.645748, 0.404688)
bones/8/rotation = Quaternion(0.997471, 0.0220322, 0.0652041, -0.0177264)
bones/8/scale = Vector3(1.00775, 0.9847, 1.00775)
bones/9/position = Vector3(0.267408, 0.531971, 0.402279)
bones/9/rotation = Quaternion(0.99747, 0.0220594, 0.065216, -0.0177273)
bones/9/scale = Vector3(1.00775, 0.984699, 1.00775)
bones/10/position = Vector3(0.272764, 0.418194, 0.39987)
bones/10/rotation = Quaternion(0.711115, -0.00107168, -0.00108433, 0.703074)
bones/10/scale = Vector3(0.999956, 1.00009, 0.999951)
bones/11/position = Vector3(0.272764, 0.415033, 0.705164)
bones/11/rotation = Quaternion(-4.27343e-09, 0.78288, 0.622172, -5.37725e-09)
bones/12/position = Vector3(-0.246847, 0.704269, 0.0698663)
bones/12/rotation = Quaternion(0.962263, 0.0374759, -0.0639672, -0.261827)
bones/12/scale = Vector3(1.00439, 0.991276, 1.00439)
bones/13/position = Vector3(-0.240369, 0.562431, -0.0148028)
bones/13/rotation = Quaternion(0.798189, 0.0112992, -0.0695958, -0.598267)
bones/13/scale = Vector3(1.00618, 0.987766, 1.00618)
bones/14/position = Vector3(-0.248226, 0.528374, -0.129839)
bones/14/rotation = Quaternion(0.798426, 0.00931212, -0.0668328, -0.598299)
bones/14/scale = Vector3(1.00618, 0.987766, 1.00618)
bones/15/position = Vector3(-0.256084, 0.494317, -0.244876)
bones/15/rotation = Quaternion(0.989215, -0.000222158, -0.00150599, 0.14646)
bones/15/scale = Vector3(1.00002, 0.99997, 1.00001)
bones/16/position = Vector3(-0.256083, 0.205374, -0.158264)
bones/16/rotation = Quaternion(-6.85063e-09, 0.263391, 0.964689, -1.87045e-09)
bones/17/position = Vector3(0.485902, 1.44822, 0.197653)
bones/17/rotation = Quaternion(0.133504, 0.436578, -0.837665, 0.299822)
bones/17/scale = Vector3(1.00841, 0.983384, 1.00841)
bones/18/position = Vector3(0.611385, 1.35911, 0.0654939)
bones/18/rotation = Quaternion(0.275166, 0.0854691, -0.940571, 0.179736)
bones/18/scale = Vector3(1.00918, 0.981881, 1.00918)
bones/19/position = Vector3(0.680654, 1.19271, 0.0541858)
bones/19/rotation = Quaternion(0.272461, 0.084958, -0.941522, 0.17912)
bones/19/scale = Vector3(1.00918, 0.981881, 1.00918)
bones/20/position = Vector3(0.749922, 1.02631, 0.0428777)
bones/20/rotation = Quaternion(0.260031, 0.0950538, -0.959124, 0.058556)
bones/21/position = Vector3(-0.506278, 1.42087, 0.203678)
bones/21/rotation = Quaternion(0.162594, -0.433482, 0.837666, 0.289779)
bones/21/scale = Vector3(1.01232, 0.975805, 1.01232)
bones/22/position = Vector3(-0.633214, 1.32821, 0.0775441)
bones/22/rotation = Quaternion(0.318195, 0.00372779, 0.940406, 0.119893)
bones/22/scale = Vector3(1.01355, 0.973439, 1.01355)
bones/23/position = Vector3(-0.67248, 1.15459, 0.0897293)
bones/23/rotation = Quaternion(0.281352, 0.00840041, 0.952087, 0.119583)
bones/23/scale = Vector3(1.01355, 0.973438, 1.01355)
bones/24/position = Vector3(-0.712522, 0.980103, 0.104684)
bones/24/rotation = Quaternion(0.246311, 0.0284242, 0.965445, 0.0802379)
bones/26/position = Vector3(0.0161514, 0.84363, 0.104894)
bones/26/rotation = Quaternion(0.252072, 0.00503149, 0.0193116, 0.967503)
bones/26/scale = Vector3(1, 1, 1)
bones/27/position = Vector3(0.0161513, 0.84363, 0.104894)
bones/27/rotation = Quaternion(-0.187004, -0.539818, -0.5787, 0.582008)
bones/27/scale = Vector3(1, 1, 1)
bones/28/position = Vector3(0.0161514, 0.84363, 0.104894)
bones/28/rotation = Quaternion(-0.208397, 0.531925, 0.601463, 0.558451)
bones/28/scale = Vector3(1, 1, 1)
bones/29/position = Vector3(0.285088, 0.867319, 0.154535)
bones/29/rotation = Quaternion(0.909535, -0.00855457, 0.0657308, 0.410308)
bones/29/scale = Vector3(1.00551, 0.989087, 1.00551)
bones/30/position = Vector3(-0.253812, 0.846465, 0.154535)
bones/30/rotation = Quaternion(0.962062, 0.038361, -0.0668663, -0.261713)
bones/30/scale = Vector3(1.00439, 0.991276, 1.00439)
bones/31/position = Vector3(0.00675182, 1.62915, 0.466886)
bones/31/rotation = Quaternion(0.591306, 0.301892, 0.504134, -0.552329)
bones/31/scale = Vector3(1.05736, 1.05736, 1.05736)
bones/32/position = Vector3(0.360419, 1.53733, 0.329812)
bones/32/rotation = Quaternion(0.089971, 0.420494, -0.84342, 0.322075)
bones/32/scale = Vector3(1.00841, 0.983384, 1.00841)
bones/33/position = Vector3(-0.0319251, 1.62792, 0.466886)
bones/33/rotation = Quaternion(0.600841, -0.282439, -0.521887, -0.535586)
bones/33/scale = Vector3(1.05736, 1.05736, 1.05736)
bones/34/position = Vector3(-0.379342, 1.51354, 0.329812)
bones/34/rotation = Quaternion(0.111656, -0.415177, 0.84596, 0.315457)
bones/34/scale = Vector3(1.01232, 0.975805, 1.01232)

[node name="Cylinder" parent="small_ennemy_animated" index="1"]
visible = false

[node name="MeshInstance3D" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.5, 0)
visible = false
mesh = SubResource("BoxMesh_u8d4u")

[editable path="small_ennemy_animated"]
